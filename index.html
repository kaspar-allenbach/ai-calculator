<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AI - Calculator</title>
    <meta name="description" content="Gets you results as accurate as Microsoft AI">
    <style>
        * {
      box-sizing: border-box;
    }
    :root {
      --calcWidth: 40vh;
    }
    body {
      background: #fcfcfc;
    }
    .wrapper {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
    }
    
    .calculator, .whatsThis {
      width: var(--calcWidth);
    }
    .input {
      display: grid;
      width: 100%;
      height: 100px;
      grid-template-columns: repeat(4,1fr);
      grid-gap: 2px;
      margin-bottom: 20px;
      button {
        min-height: 30px;
      }
    }
    .operators{
      grid-column-start: 4;
      grid-row-start: 1; 
      grid-row-end: 5;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      grid-gap: 2px;
      padding-left: 10px;
    }
    .clippy {
      position: relative;
      text-align: center;
    }
    .hint {
      position: absolute;
      top: 30px;
      left: -90px;
    }
    .output {
      background: #ddd;
      width: 100%;
      height: 40px;
      margin-bottom: 10px;
      padding: 20px;
      font-size: 20px;
      text-align: right;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      border-radius: 5px;
    }
    </style>
</head>

<body>

    <div class="wrapper">

        <div class="calculator">
            <div class="clippy">
                <img src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExaTFvdGZvc3VjcDM1eXM1Z2dqY2VxdTBzc3U5cGU0ajlhMzBhd2prMCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/13V60VgE2ED7oc/giphy.gif" alt="">
                <div class="hint"></div>
            </div>
            <div class="output"></div>
            <div class="input">
                <button class="1">1</button>
                <button class="2">2</button>
                <button class="3">3</button>
                <button class="4">4</button>
                <button class="5">5</button>
                <button class="6">6</button>
                <button class="7">7</button>
                <button class="8">8</button>
                <button class="9">9</button>
                <button class="0">0</button>
                <div class="operators">
                    <button class="add">+</button>
                    <button class="substract">-</button>
                    <button class="mulitply">*</button>
                    <button class="result">=</button>
                    <button class="c">C</button>
                </div>
            </div>
        </div>

        <div class="whatsThis">
            <p>A calculator which has the <a href="https://www.theverge.com/news/787076/microsoft-office-agent-mode-office-agent-anthropic-models#comments">Error Rate</a> of the new Microsoft Agent</p>
            <label for="errorRate">Error Rate</label>
            <input type="number" name="errorRate" value="57">
            <p>You can change the error rate with the number input. Value <code>100</code> means: no error. But that number input doesn't do anything because this shit is vibe coded.</p>
            <hr> Thanks for coming to my TED talk. <a href="https://atelier.kaspar-allenbach.ch/en/">Kaspar Allenbach</a>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const output = document.querySelector(".output");
          const hint = document.querySelector(".hint"); // new hint div
          const buttons = document.querySelectorAll(".input button");
          const errorInput = document.querySelector("input[name='errorRate']");
          let expression = "";
        
          // Helper: generate a random "wrong" number
          function generateWrongResult() {
            return (Math.random() * 10000 - 5000).toFixed(2);
          }
        
          // Helper: get current error rate %
          function getErrorRate() {
            const val = parseFloat(errorInput.value);
            return isNaN(val) ? 0 : Math.min(Math.max(val, 0), 100);
          }
        
          // Render expression/result to output
          function updateOutput(value) {
            output.textContent = value;
          }
        
          // Render hint message
          function updateHint(message) {
            hint.textContent = message || "";
          }
        
          buttons.forEach((btn) => {
            btn.addEventListener("click", () => {
              const value = btn.textContent.trim();
        
              if (btn.classList.contains("result")) {
                try {
                  let result = eval(expression); // ⚠️ toy project only
                  const errorRate = getErrorRate();
        
                  if (Math.random() * 100 < errorRate) {
                    result = generateWrongResult();
                    updateHint("you sure about that?");
                  } else {
                    updateHint(""); // clear hint
                  }
        
                  updateOutput(result);
                  expression = result.toString(); // allow chaining
                } catch (err) {
                  updateOutput("Error");
                  updateHint("");
                  expression = "";
                }
              } else if (btn.classList.contains("c")) {
                expression = "";
                updateOutput("");
                updateHint("");
              } else {
                expression += value;
                updateOutput(expression);
              }
            });
          });
        });
    </script>
</body>

</html>
